<div class="tab-container">
  <h2>SOP</h2>
  <div>
    <b>Search SOP</b>
    &nbsp;
    <label for="activeCheckBox">Active SOP Only:</label>
    <input type="checkbox"
           [(ngModel)]="search.active"
           id="activeCheckBox" >
  </div>
  <div class="input-group">

    <span class="input-group-text" id="basic-addon1" (click)="page =1;searchSop();">
      <i class="fa fa-search" aria-hidden="true"></i>
    </span>
    <input autocomplete="off"
            type="text"
            class="form-control"
            placeholder="Search Standard Operating Procedure by Id or Name"
            aria-describedby="basic-addon1"
            [(ngModel)]="search.searchValue"
            (keyup.enter)="page=1; searchSop()">
  </div>

  <div class="row control-box">
      <div ngbDropdown style="display: inline-block;">
          <button class="btn btn-default menu-btn" id="dropdownBasic1" ngbDropdownToggle>
            <i class="fa fa-list" aria-hidden="true"></i> Edit View</button>
          <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
            <button *ngFor="let mode of columnList; let i = index;" class="dropdown-item" (click)="toggleViewCol(i)">
              <input autocomplete="off" type="checkbox" [checked]="viewColumn[i]">{{mode}}</button>
          </div>
        </div>


    <button *ngIf="canManageSOP" class="btn btn-default menu-btn" (click)="createNewSop()">
      <i class="fa fa-plus" aria-hidden="true"></i> New SOP
    </button>

  </div>

  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 table-container">
    <table class="table table-scroll">
      <thead>

        <tr>
          <th *ngIf="viewColumn[0]">SOP Id</th>
          <th *ngIf="viewColumn[1]">Name</th>
          <th *ngIf="viewColumn[2]">Volume</th>
          <th *ngIf="viewColumn[3]">Unit</th>
          <th *ngIf="viewColumn[4]">Description</th>
          <th *ngIf="viewColumn[5]">Entered Person</th>
          <th *ngIf="viewColumn[6]">Reviewd Person</th>
          <th *ngIf="viewColumn[7]">Review Comment</th>
          <th *ngIf="viewColumn[8]">Edit Status</th>
          <th *ngIf="viewColumn[9]">Active</th>
          <th *ngIf="viewColumn[10]" colspan="8">Direction</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let s of displaySops; let i = index"  [routerLink]="['/main/sop', s.sopId]" class="shadow-row">
          <td *ngIf="viewColumn[0]">{{s.sopIdentifier}}</td>
          <td *ngIf="viewColumn[1]">
            <a class="sop-name">{{s.name}}</a>
          </td>
          <td *ngIf="viewColumn[2]">{{s.volume}}</td>
          <td *ngIf="viewColumn[3]">{{s.unit}}</td>
          <td *ngIf="viewColumn[4]" >{{s.description}}</td>
          <td *ngIf="viewColumn[5]"  class="angular-with-newlines">{{s.enteredBy}}</td>
          <td *ngIf="viewColumn[6]" >{{s.reviewedBy}}</td>
          <td *ngIf="viewColumn[7]">{{s.editStatusComment}}</td>
          <td *ngIf="viewColumn[8]">{{s.editStatus}}</td>
          <td *ngIf="viewColumn[9]">{{s.active}}</td>
          <td *ngIf="viewColumn[10]" colspan="8">{{s.direction}}</td>

        </tr>
        <tr *ngIf="displaySops == undefined || displaySops.length < 1">
          <td class="empty" colspan="18">Empty</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="count>10">
    <p class="page-note" [style.text-align]="'center'">SOP {{((page-1)*10)+1}} - {{page*10>count?count:page*10}} of {{count}}
      SOP(s)
    </p>
    <ngb-pagination
                   class="d-flex justify-content-center"
                   [collectionSize]="count"
                   [(page)]="page"
                   [maxSize]="5"
                   aria-label="Default pagination"
                   (pageChange)="loadPage()"></ngb-pagination>
  </div>


  <div *ngIf="isLoading" class="loading-screen">
    <img class="loading-img" src="../../../assets/images/loading.gif">
  </div>
</div>


<!-- <div [style.right]="isShowSop?0+'px':-100+'%'" class="slide">
  <div class="edit-container">
    <h2>
      <div class="control-box" style="text-align:right;">
        <button class="btn btn-default menu-btn" (click)="reset()"><i class="fas fa-times"></i></button>
      </div>
      {{isNewSop?'New SOP':displaySop?.name}}
      <small *ngIf="!isNewSop && canManageSOP">
        <button class="btn-icon" (click)="enableEditSop=true">
          <i class="fas fa-pen-square"></i>
        </button>
      </small>
      <br>

    </h2>
    <app-sop-display [sop]="displaySop"
                     [enableEdit]="enableEditSop"
                     [isNew]="isNewSop"
                     (updateSop)="saveSop($event)"
                     (cancel)="reset()">
    </app-sop-display>
  </div>
</div> -->

<div [style.right]="isShowSop?0+'px':-100+'%'" class="slide">
  <div class="edit-container">
    <h2>

      <div class="sop-header-container" style="text-align:right;">
        <h1>{{isNewSop?'New SOP':displaySop?.name}}</h1>
        <button  (click)="reset()"><i class="fas fa-times"></i></button>
      </div>

      <div class="sop-operation-container" *ngIf="!isNewSop && canManageSOP">
        <span (click)="enableEditSop=true">
          Edit
        </span>
      </div>

    </h2>
    <app-sop-display [sop]="displaySop"
                     [enableEdit]="enableEditSop"
                     [isNew]="isNewSop"
                     (updateSop)="saveSop($event)"
                     (cancel)="reset()">
    </app-sop-display>
  </div>
</div>



